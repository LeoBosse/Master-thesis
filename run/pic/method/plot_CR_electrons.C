
#include <iostream>
#include <stdlib.h>
#include <string>
#include <fstream>
#include <math.h>  

void plot_CR_electrons(){
	
	TCanvas *CB = new TCanvas("bin_ex","bin_ex", 900,900);
	CB->SetBorderMode(0);
	CB->SetBorderSize(2);
// 	double rm = CB->GetRightMargin();
	double lm = CB->GetLeftMargin();
	CB->SetLeftMargin(lm+0.02);
	CB->SetRightMargin(lm-0.02);
	CB->SetFillStyle(1001);
	CB->SetFillColor(10);
	CB->SetLogx();
	CB->SetLogy();
	CB->cd();
	
	
	
	double data_X[74] = {0.1,0.5687853044039375,
0.7334221317585979,
0.9178479786512869,
1.1064998933907022,
1.3156172255806198,
1.5724286318438487,
1.8556748980770745,
2.1525556384701194,
2.4593571240579486,
2.8174387239746905,
3.915005456385838,
3.1754850803939285,
3.5259100125235827,
4.73483293717805,
4.3470388265980695,
5.211211758929469,
5.719580250566628,
6.25205934505877,
6.831393479085533,
7.333280009031298,
7.918683455927676,
8.550818678402791,
9.97050432833267,
9.179027363473804,
10.703014003624565,
11.354383702293909,
12.188563764306656,
13.084029087950906,
13.717263434072226,
14.638301878841043,
15.43769387093481,
16.37720922627816,
17.476848333445673,
18.540463631789766,
19.55295116481309,
20.499265191047925,
21.746820336347515,
22.799312153916667,
24.18684477627288,
25.208061421682086,
26.584663885785382,
28.036442076910085,
29.220196369453387,
30.998494566370972,
32.498744321666784,
34.47657012744136,
35.93223942273116,
38.3448907561428,
40.43889037863164,
43.15413842220261,
44.7112625857924,
47.43232430053647,
51.52225568291579,
54.015804242671926,
57.30312668483782,
61.51305361920988,
66.03227405671367,
69.6382709501769,
74.31409605775804,
80.72195310676084,
86.65240654341754,
94.68187237787745,
102.8459749575255,
112.37598427953333,
124.9847309313109,
141.4938788620222,
158.30216356656135,
184.58494635272126,
215.231438739692,
263.11227885509504,
327.3962986563611,
429.63350236302847,
594.5853985844064};
	
	double data_Y[74] = {0, 14.678800016534925,
24.060992709169415,
21.081491866990284,
18.526658889350962,
16.14531819669599,
13.722359484929465,
11.228730916776167,
8.78890371394203,
6.976259270771173,
5.446902056401045,
2.815628432556877,
4.618309656271823,
3.5470710795277935,
1.820741903088739,
2.2350168047035797,
1.381517510154636,
1.0828116812861024,
0.8765515575308495,
0.6932666127922515,
0.5412241548039997,
0.42806256303862805,
0.35205278394121375,
0.22022566809995534,
0.27844632353679255,
0.18349697945782747,
0.14896475306922327,
0.11781951377955165,
0.0956455063066016,
0.07969665027771504,
0.06640559617133446,
0.05461597982840505,
0.04491911077964631,
0.03694357698452951,
0.030782733561206376,
0.02531758243543567,
0.021652665634903655,
0.01804178944037393,
0.015430100216084472,
0.013196252793539243,
0.011140035431021211,
0.009404057171950649,
0.008042679621191862,
0.006701621488837661,
0.005440445903784143,
0.004652899081491316,
0.003876964939607967,
0.0032728629458511904,
0.0028357170215203924,
0.002332265239315452,
0.0020207519676957142,
0.0016405222524632427,
0.0013669428766996037,
0.0011096613343866645,
0.0009246256798497661,
0.0007704317846261475,
0.0006254340707358751,
0.0004946696221556789,
0.0003963844885523424,
0.00031762216697961665,
0.00025121019030872156,
0.00019868768865671465,
0.00015510898561514938,
0.00012267707309444517,
0.00009090800503800397,
0.00006563210360053037,
0.00004325356401540348,
0.00002964184201884255,
0.00001903176124258145,
0.000011010276267017045,
0.000006537354908593484,
0.0000031104920175815583,
0.0000011859258328614402,
4.4049367000277495e-7};
	
	CB->cd();


	double min = 0.05, max = 2e3;
	
	TGraph* g_data = new TGraph(74,data_X,data_Y);
	g_data->Draw("AP");
	g_data->SetMarkerStyle(20);
	g_data->SetMarkerSize(1);
	g_data->SetMarkerColor(kBlue);
	g_data->GetXaxis()->SetTitle("R (GV)");
	g_data->GetYaxis()->SetTitle("#phi (GV^{-1} cm^{-2} s^{-1} sr^{-1})");
	//	g_data->GetXaxis()->SetRange(min, max);
	//	g_data->GetXaxis()->SetRangeUser(min, max);
	g_data->GetYaxis()->SetRangeUser(1e-6, 1e6);
	g_data->GetXaxis()->SetTitleOffset(1.3);
	g_data->GetYaxis()->SetTitleOffset(1.5);
	g_data->GetXaxis()->CenterTitle();
	g_data->GetYaxis()->CenterTitle();
	
	int norm_point = 50;
	
	
	int const N = 100000;
	double x[N], y[N];
	for (Int_t i=0; i<N; i++) {
		x[i] = min + i * 0.05;
		double b = 0.2;
		if(x[i] <= b)
			y[i] = pow(x[i], -0.81) * pow(b, -3.21) / pow(b, -0.81) * data_Y[norm_point] / pow(data_X[norm_point], -3.21);
		else
			y[i] = pow(x[i], -3.21) * data_Y[norm_point] / pow(data_X[norm_point], -3.21);
	}
	TGraph* g_prop = new TGraph(N,x,y);
	g_prop->Draw("sameL");
	g_prop->SetLineColor(kRed+1);
	//g_prop->SetLineStyle(2);
	g_prop->SetLineWidth(4);
	g_prop->SetMarkerStyle(20);
	g_prop->SetMarkerSize(1);
	g_prop->SetMarkerColor(kRed+1);




	TLegend *l_dat = new TLegend(0.15,0.1,0.6,0.5,""); //(0.57,0.7,0.7,0.89)
	l_dat->SetBorderSize(0);
	l_dat->SetFillStyle(0);
	l_dat->SetTextSize(0.025);
	l_dat->SetTextFont(62);

	l_dat->AddEntry(g_data, "AMS-02 electron data", "p");
	l_dat->AddEntry(g_prop,"Interstellar ~R^{-3.21} (above break)","l");
	l_dat->AddEntry(g_prop, "Interstellar ~R^{-0.81} (below break)", "l");

	l_dat->Draw();

	char profile_name[300];
        sprintf(profile_name,"./CR_electrons.png");
        CB->SaveAs(profile_name);
        sprintf(profile_name,"./CR_electrons.pdf");
	CB->SaveAs(profile_name);
        sprintf(profile_name,"./CR_electrons.C");
	CB->SaveAs(profile_name);
        sprintf(profile_name,"./CR_electrons.root");
	CB->SaveAs(profile_name);



}
